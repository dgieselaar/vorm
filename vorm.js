"use strict";var babelHelpers={};babelHelpers.slicedToArray=function(r,e){if(Array.isArray(r))return r;if(Symbol.iterator in Object(r)){for(var t,a=[],n=r[Symbol.iterator]();!(t=n.next()).done&&(a.push(t.value),!e||a.length!==e););return a}throw new TypeError("Invalid attempt to destructure non-iterable instance")};!function(){angular.module("vorm",[])}();!function(){angular.module("vorm").factory("VormModelDelegate",[function(){return function(e){var n={},t=void 0;return n.value=void 0,n.getName=function(){return e},n.setNgModel=function(){t=arguments[0]},n.getNgModel=function(){return t},n.clearValue=function(){t.$setViewValue(void 0),t.$render()},n}}])}();!function(){angular.module("vorm").factory("VormEvent",["$document","$window",function(t,n){var e=void 0;try{{new n.CustomEvent("foo")}e=function(t,e){return new n.CustomEvent(t,{detail:e,bubbles:!0})}}catch(o){e=function(n,e){var o=t[0].createEvent("CustomEvent");return o.initCustomEvent(n,!0,!0,e),o}}return e}])}();!function(){angular.module("vorm").factory("VormFieldCtrl",["VormEvent","VormValueType",function(e,n){return function(t,i){function u(e,n){var t=e.$viewChangeListeners,i=e.$modelValue;e.$viewChangeListeners=[],e.$modelValue=n,e.$$writeModelToScope(),e.listeners=t,e.$modelValue=i}function r(){i.dispatchEvent(new e("viewchange",{name:t})),_.invoke(l,"call",null,t)}function a(){i.dispatchEvent(new e("modelchange",{name:t})),_.invoke(s,"call",null,t)}var o={},c=[],l=[],s=[],d="vorm-field-",f=n.SINGLE,v=void 0;o.getName=function(){return t},o.setName=function(){t=arguments[0]},o.addModel=function(e){c.push(e),e.$viewChangeListeners.push(r),e.$formatters.push(a)},o.removeModel=function(e){_.pull(c,e),_.pull(e.$viewChangeListeners,r),_.pull(e.$formatters,a)},o.getModels=function(){return c},o.getValue=function(){var e=void 0;switch(f){case n.SINGLE:e=c[0]?c[0].$modelValue:void 0;break;case n.LIST:e=_.pluck(c,"$modelValue");break;case n.NAMED:e={},_.each(c,function(n){e[n.$name]=n.$modelValue})}return e},o.getValueType=function(){return f},o.setValueType=function(e){if(-1===[n.SINGLE,n.LIST,n.NAMED].indexOf(e))throw new Error("Unsupported VormValueType: "+n);f=e},o.setValue=function(e){switch(f){case n.SINGLE:c[0]&&u(c[0],e);break;case n.LIST:_.each(c,function(n,t){u(n,e[t])});break;case n.NAMED:var t=c.concat();_.each(e,function(e,n){var i=_.find(c,{$name:n});i&&u(i,e),_.pull(t,i)}),_.each(t,function(e){u(e,void 0)})}},o.isRequired=function(){return v},o.setRequired=function(){v=!!arguments[0]},o.isEmpty=function(){return c.every(function(e){return e.$isEmpty()})};var m=_("valid invalid dirty pristine touched untouched required empty".split(" ")).map(function(e){return d+e}).zipObject().mapValues(function(e,n){var t=n.substr(d.length);return o["is"+_.capitalize(t)]()}).each(function(){});return o.getClassObj=function(){return m.value()},o.viewChangeListeners=l,o.modelChangeListeners=s,"valid invalid dirty pristine touched untouched".split(" ").forEach(function(e){var n=_.capitalize(e),t="is"+n,i="$"+e,u="set"+n,r=-1!==["valid","pristine","untouched"].indexOf(e)?"every":"some";o[t]=function(){return c[r](function(e){return e[i]})},"valid"!==e&&"invalid"!==e&&(o[u]=function(){var e=arguments;c.forEach(function(n){n["$"+u].apply(n,e)})})}),o}}])}();!function(){angular.module("vorm").factory("VormModelListCtrl",["VormModelDelegate",function(e){return function(){var t=this,n=[];t.getDelegates=function(){return n},t.clearDelegate=function(e){1===n.length?e.clearValue():_.pull(n,e)},t.addDelegate=function(t){var l=void 0;t||(t=n.length.toString()),l=new e(t),n.push(l)}}}])}();!function(){angular.module("vorm").constant("VormValueType",{SINGLE:"single",LIST:"list",NAMED:"named"})}();!function(){angular.module("vorm").directive("ngModel",["VormFieldCtrl",function(e){return{require:["ngModel","^?vormField","^?vormForm","^?vormInput"],link:function(o,r,n,d){var l=babelHelpers.slicedToArray(d,3),i=l[0],t=l[1],u=l[2];(t||u)&&(t||(t=new e(n.ngModel,r[0]),u.addField(t),o.$on("$destroy",function(){u.removeField(t)})),t.addModel(i),o.$on("$destroy",function(){t.removeModel(i)}))}}}])}();!function(){angular.module("vorm").directive("vormChange",["$parse",function(n){return{link:function(e,a,i){function r(n,a){t(e,{$event:n,$name:n.detail?n.detail.name:a})}var t=n(i.vormChange);a.bind("viewchange",r)}}}])}();!function(){angular.module("vorm").directive("vormField",["VormFieldCtrl",function(e){return{scope:!0,require:["vormField","^?vormForm"],controller:["$scope","$element","$attrs",function(r,o,l){var n=r.$eval(l.vormField)||l.ngModel,i=this;angular.extend(i,new e(n,o[0]))}],controllerAs:"vormField",link:function(e,r,o,l){var n=babelHelpers.slicedToArray(l,2),i=n[0],t=n[1];t&&(t.addField(i),e.$on("$destroy",function(){t.removeField(i)}))}}}])}();!function(){angular.module("vorm").directive("vormFieldTemplate",["vormTemplateService","VormValueType","VormModelListCtrl",function(e,t,l){var a=angular.element('\n				<div class="vorm-input-list">\n					<div class="vorm-input-list-item" ng-repeat="delegate in vormFieldTemplate.getDelegates()">\n						<vorm-input delegate="delegate" compiler="vormFieldTemplate.getModelCompiler()" data="vormFieldTemplate.getInputData()"></vorm-input>\n						<button type="button" ng-click="vormFieldTemplate.clearDelegate(delegate)" ng-show="vormField.getValueType()===\'multiple\'">x</button>\n					</div>\n				</div>\n			');return{restrict:"E",require:["vormFieldTemplate","vormField"],template:function(){var t=angular.element(e.getDefaultTemplate());return angular.element(t[0].querySelectorAll("[ng-transclude], ng-transclude")).replaceWith(a),t[0].outerHTML},replace:!0,controller:["$scope","$attrs",function(a,n){var r=this,i=new l,o=[],u=a.$eval(n.config)||{},m=void 0,d=void 0;if(u=_.defaults(angular.copy(u),{name:n.name,type:n.type,label:n.label,template:a.$eval(n.template),data:a.$eval(n.data)}),!u.name||!u.type)throw new Error("Missing one of required arguments: name, type ");m=e.getModelCompiler(u.type,u.modelTemplate),r.link=function(e){d=e[0],d.setName(u.name),u.limit>1&&d.setValueType(t.LIST),d.setRequired(u.required||!1),i.addDelegate()},r.getLabel=function(){return u.label},r.getModelCompiler=function(){return m},r.getInputData=function(){return u.data},r.addInput=function(e){o.push(e)},r.removeInput=function(e){_.pull(o,e)},r.getInputs=function(){return o},r.getLastInputId=function(){var e,t=_.last(o);return t&&(e=t.getInputId()),e},r.getDelegates=i.getDelegates,r.addDelegate=i.addDelegate,r.clearDelegate=i.clearDelegate}],controllerAs:"vormFieldTemplate",link:function(e,t,l,a){a[0].link(a.slice(1))}}}])}();!function(){angular.module("vorm").directive("vormFieldWrapper",["vormTemplateService",function(e){return{restrict:"EA",transclude:!0,replace:!0,template:e.getDefaultTemplate()}}])}();!function(){angular.module("vorm").directive("vormFieldset",[function(){return{restrict:"E",template:'\n					<fieldset>\n						<vorm-field-template config="field" ng-repeat="field in vormFieldset.getFields()">\n						</vorm-field-template>\n					</fieldset>\n				',scope:{fields:"&"},replace:!0,controller:["$scope",function(e){var t=this;t.getFields=e.fields}],controllerAs:"vormFieldset"}}])}();!function(){angular.module("vorm").directive("vormForm",[function(){return{scope:!0,require:["form"],controller:["$element",function(e){function n(){l=_(u).indexBy(function(e){return e.getName()}).mapValues(function(e){return e.getValue()}).value(),Object.freeze(l)}function t(){var e=arguments;n(),_.each(o,function(n){n.apply(r,e)})}function i(){n()}var r=this,u=[],o=[],s=[],l={};return r.addField=function(e){u.push(e),e.viewChangeListeners.push(t),e.modelChangeListeners.push(i),n()},r.removeField=function(e){_.pull(u,e),_.pull(e.viewChangeListeners,t),_.pull(e.modelChangeListeners,i),n()},r.getFields=function(){return u},r.getValues=function(){return l},r.changeListeners=o,r.submitListeners=s,"valid invalid dirty pristine touched untouched".split(" ").forEach(function(e){var n=e.substr(0,1).toUpperCase()+e.substr(1),t="is"+n,i="set"+n,o=-1!==["valid","pristine","untouched"].indexOf(e)?"every":"some";r[t]=function(){return u[o](function(e){return e[t]()})},"valid"!==e&&"invalid"!==e&&(r[i]=function(){var e=arguments;u.forEach(function(n){n[i].apply(n,e)})})}),e.bind("submit",function(){_.invoke(s,"call",null,l)}),r}],controllerAs:"vormForm"}}])}();!function(){angular.module("vorm").directive("vormInput",["vormInvoke",function(t){return{require:["vormInput","^vormField","^vormFieldTemplate","^?vormForm"],scope:{compiler:"&",delegate:"=",data:"&"},controller:["$scope",function(e){var n,o,r,i=this,u=Math.random().toString(36).slice(2);i.link=function(t){n=t[0],o=t[1],r=t[2],o.addInput(i)},i.isRequired=function(){return n&&n.isRequired()},i.getInputId=function(){return u},i.getOptions=angular.version.minor>=4?function(){return i.getInvokedData("options")}:function(){var t=void 0;return function(){var e=i.getInvokedData("options");return t===e||angular.equals(t,e)||(t=e),t}}(),i.getInvokedData=function(e){var o=void 0;return r?o=r.getValues():(o={},o[n.getName()]=n.getValue()),t(i.getData()[e],{$values:o})},i.getData=e.data,e.$on("$destroy",function(){o.removeInput(i)})}],controllerAs:"vormInput",link:function(t,e,n,o){o[0].link(o.slice(1)),t.compiler()(t,function(n){e.replaceWith(n),n.attr("id",o[0].getInputId()),t.$$postDigest(function(){t.delegate.setNgModel(n.controller("ngModel"))})})}}}])}();!function(){angular.module("vorm").factory("vormInvoke",["$injector",function(n){return function(o,r){var t;return o?t=_.isArray(o)&&"function"==typeof _.last(o)||void 0!==o.$inject?n.invoke(o,null,angular.copy(r)):"function"==typeof o?o():o:o}}])}();!function(){angular.module("vorm").directive("vormModelList",["VormModelListCtrl",function(o){return{controller:[function(){o.apply(this,null)}],controllerAs:"vormModelList"}}])}();!function(){angular.module("vorm").directive("vormSubmit",["$parse",function(r){return{require:["vormForm"],link:function(e,i,u,n){function o(){a(e,{$values:m.getValues()})}var t=babelHelpers.slicedToArray(n,1),m=t[0],a=void 0;a=r(u.vormSubmit),i.bind("submit",o)}}}])}();!function(){angular.module("vorm").provider("vormTemplateService",[function(){var e=void 0,n=void 0,t={},o={};return e='\n				<div class="vorm-field"\n					ng-class="vormField.getClassObj()"\n					vorm-field\n				>\n					<label class="vorm-field-label" for="{{vormFieldTemplate.getLastInputId()}}">\n						{{vormFieldTemplate.getLabel()}}\n					</label>\n					\n					<div class="vorm-input" ng-transclude>\n						\n					</div>\n					\n					<div class="vorm-field-status">\n						\n					</div>\n				</div>\n			',t.text='<input type="text" placeholder="{{vormInput.getData().placeholder}}"/>',t.number='<input type="number"/>',t.select='<select ng-options="option.value as option.label for option in vormInput.getOptions()"><option value="" data-ng-show="vormInput.getInvokedData(\'notSelectedLabel\')">{{vormInput.getInvokedData(\'notSelectedLabel\')}}</option></select>',t=_.mapValues(t,function(e){return angular.element(e)}),{$get:["$compile",function(l){return o.getDefaultTemplate=function(){return e},o.getModelCompiler=function(e,t){var o=void 0;if(o=t?l(t):n[e],!o)throw new Error("Model template for "+e+" not found");return o},n=_.mapValues(t,function(e){return e.attr("ng-model","model.value"),e.attr("ng-required","vormInput.isRequired()"),l(e)}),o}],modifyModelTemplates:function(e){t=_.mapValues(t,function(n,t){return e(n,t)})}}}])}();!function(){angular.module("vorm").factory("VormModelDelegate",[function(){return function(e){var n={},t=void 0;return n.value=void 0,n.getName=function(){return e},n.setNgModel=function(){t=arguments[0]},n.getNgModel=function(){return t},n.clearValue=function(){t.$setViewValue(void 0),t.$render()},n}}])}();
//# sourceMappingURL=vorm.js.map